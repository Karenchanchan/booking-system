<!DOCTYPE html>
<html lang="zh-Hant" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>心理輔導室預約系統 | Counselling Room Booking System</title>
    
    <!-- GitHub API 不需要額外引入 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-color: #3b82f6;
            --secondary-color: #1e40af;
            --accent-color: #8b5cf6;
            --light-bg: #f8fafc;
        }
        
        body {
            font-family: 'Inter', 'Noto Sans TC', sans-serif;
            background-color: var(--light-bg);
        }
        
        .chinese-font {
            font-family: 'Noto Sans TC', sans-serif;
        }
        
        .english-font {
            font-family: 'Inter', sans-serif;
        }
        
        .bilingual-text {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }
        
        .bilingual-text .english {
            font-family: 'Inter', sans-serif;
            font-size: 0.95em;
        }
        
        .bilingual-text .chinese {
            font-family: 'Noto Sans TC', sans-serif;
            font-size: 0.85em;
            color: #666;
        }
        
        .bilingual-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
        }
        
        .bilingual-label .english {
            font-family: 'Inter', sans-serif;
            font-weight: 500;
        }
        
        .bilingual-label .chinese {
            font-family: 'Noto Sans TC', sans-serif;
            color: #666;
            font-size: 0.9em;
        }
        
        .print-header, .print-footer {
            display: none;
        }
        
        @media print {
            .no-print {
                display: none !important;
            }
            
            .print-only {
                display: block !important;
            }
            
            .print-header, .print-footer {
                display: block;
            }
            
            body {
                background: white !important;
                font-size: 12pt;
            }
            
            .print-page-break {
                page-break-before: always;
            }
            
            .print-border {
                border: 1px solid #ddd !important;
            }
        }
        
        .slot-booked {
            background-color: #f3f4f6 !important;
            color: #9ca3af !important;
            cursor: not-allowed !important;
            text-decoration: line-through;
        }
        
        .slot-selected {
            background-color: #3b82f6 !important;
            color: white !important;
            font-weight: 600;
        }
        
        .slot-available {
            background-color: #dbeafe !important;
            color: #1e40af !important;
            cursor: pointer;
        }
        
        .slot-available:hover {
            background-color: #bfdbfe !important;
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        .slot-past {
            background-color: #f9fafb !important;
            color: #d1d5db !important;
            cursor: not-allowed !important;
        }
        
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            backdrop-filter: blur(4px);
        }
        
        .modal-content {
            background-color: white;
            border-radius: 12px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }
        
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 12px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            z-index: 999;
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from {
                transform: translateY(100%);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        .fade-in {
            animation: fadeIn 0.3s ease-out;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .tab-active {
            background-color: var(--primary-color) !important;
            color: white !important;
            font-weight: 600;
        }
        
        .tab-inactive {
            background-color: #f1f5f9 !important;
            color: #64748b !important;
        }
        
        .tab-inactive:hover {
            background-color: #e2e8f0 !important;
        }
        
        .branch-jordan {
            border-left: 4px solid #3b82f6;
        }
        
        .branch-wanchai {
            border-left: 4px solid #10b981;
        }
        
        .branch-tsuenwan {
            border-left: 4px solid #8b5cf6;
        }
        
        .room-card {
            transition: all 0.2s ease;
            border: 1px solid #e2e8f0;
        }
        
        .room-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            border-color: var(--primary-color);
        }
        
        .stats-card {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border-radius: 12px;
            padding: 20px;
        }
        
        .receipt-template {
            background: white;
            border: 2px dashed #cbd5e1;
            border-radius: 12px;
            padding: 30px;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3b82f6;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .github-config {
            background: #f6f8fa;
            border: 1px solid #e1e4e8;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }
        
        .github-config input {
            border: 1px solid #d1d5da;
            border-radius: 6px;
            padding: 8px 12px;
            font-family: monospace;
            font-size: 14px;
        }
    </style>
</head>
<body class="h-full">
    <!-- GitHub 配置設定 -->
    <div id="githubConfigModal" class="hidden modal-overlay">
        <div class="modal-content">
            <div class="p-6">
                <div class="bilingual-text mb-4">
                    <div class="english english-font text-xl font-semibold text-gray-800">GitHub Configuration</div>
                    <div class="chinese chinese-font text-gray-600">GitHub 配置設定</div>
                </div>
                
                <div class="github-config mb-4">
                    <div class="bilingual-text mb-4">
                        <div class="english english-font text-sm text-gray-700">
                            <strong>Setup Instructions:</strong><br>
                            1. Create a new GitHub repository<br>
                            2. Enable GitHub Pages (Settings > Pages)<br>
                            3. Upload this HTML file<br>
                            4. Create a GitHub Personal Access Token
                        </div>
                        <div class="chinese chinese-font text-sm text-gray-700 mt-2">
                            <strong>設置步驟:</strong><br>
                            1. 創建新的 GitHub 倉庫<br>
                            2. 啟用 GitHub Pages (設定 > Pages)<br>
                            3. 上傳此 HTML 文件<br>
                            4. 創建 GitHub Personal Access Token
                        </div>
                    </div>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1 bilingual-label">
                                <span class="english">Repository Owner</span>
                                <span class="chinese">倉庫擁有者</span>
                            </label>
                            <input type="text" id="repoOwner" class="w-full px-4 py-2 border border-gray-300 rounded-lg" placeholder="Your GitHub username">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1 bilingual-label">
                                <span class="english">Repository Name</span>
                                <span class="chinese">倉庫名稱</span>
                            </label>
                            <input type="text" id="repoName" class="w-full px-4 py-2 border border-gray-300 rounded-lg" placeholder="room-booking-system">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1 bilingual-label">
                                <span class="english">GitHub Token</span>
                                <span class="chinese">GitHub 令牌</span>
                            </label>
                            <input type="password" id="githubToken" class="w-full px-4 py-2 border border-gray-300 rounded-lg" placeholder="ghp_xxxxxxxxxxxxxxxxxxxx">
                            <div class="bilingual-text mt-1">
                                <div class="english english-font text-xs text-gray-500">
                                    Create token at: Settings > Developer settings > Personal access tokens > Tokens (classic)<br>
                                    Required scopes: repo, write:discussion
                                </div>
                                <div class="chinese chinese-font text-xs text-gray-500">
                                    創建令牌: 設定 > Developer settings > Personal access tokens > Tokens (classic)<br>
                                    所需權限: repo, write:discussion
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="githubConfigError" class="hidden text-red-500 text-sm mb-4"></div>
                
                <div class="flex gap-3">
                    <button onclick="saveGitHubConfig()" class="flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition">
                        <div class="bilingual-text items-center">
                            <div class="english english-font">Save Configuration</div>
                            <div class="chinese chinese-font text-xs">儲存配置</div>
                        </div>
                    </button>
                    <button onclick="closeGitHubConfig()" class="flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-600 hover:bg-gray-50 transition">
                        <div class="bilingual-text items-center">
                            <div class="english english-font">Cancel</div>
                            <div class="chinese chinese-font text-xs">取消</div>
                        </div>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 登入畫面 | Login Screen -->
    <div id="loginScreen" class="h-full flex items-center justify-center p-4 bg-gradient-to-br from-blue-50 to-indigo-100">
        <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md">
            <div class="text-center mb-8">
                <div class="w-20 h-20 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl mx-auto mb-4 flex items-center justify-center">
                    <i class="fas fa-door-open text-white text-3xl"></i>
                </div>
                <h1 class="text-2xl font-bold text-gray-800 english-font">Counselling Room Booking System</h1>
                <p class="text-gray-600 chinese-font">心理輔導室預約系統</p>
                
                <div class="mt-4">
                    <button onclick="showGitHubConfig()" class="text-sm text-gray-500 hover:text-gray-700">
                        <i class="fab fa-github mr-1"></i>
                        <span class="english-font">GitHub Config</span>
                        <span class="chinese-font ml-1">GitHub 設定</span>
                    </button>
                </div>
            </div>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1 bilingual-label">
                        <span class="english">Name</span>
                        <span class="chinese">姓名</span>
                    </label>
                    <input type="text" id="loginName" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition english-font" placeholder="Enter your name / 輸入姓名">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1 bilingual-label">
                        <span class="english">Password</span>
                        <span class="chinese">密碼</span>
                    </label>
                    <input type="password" id="loginPassword" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" placeholder="Enter password / 輸入密碼">
                </div>
                
                <div id="loginError" class="hidden text-red-500 text-sm text-center"></div>
                
                <button onclick="handleLogin()" class="w-full bg-gradient-to-r from-blue-500 to-indigo-600 text-white py-3 rounded-xl font-medium hover:from-blue-600 hover:to-indigo-700 transition transform hover:scale-[1.02] active:scale-[0.98] shadow-md">
                    <span class="english-font">Login</span>
                    <span class="chinese-font ml-2">登入</span>
                </button>
            </div>
            
            <div class="mt-6 pt-6 border-t border-gray-200">
                <button onclick="showStaffLogin()" class="w-full text-gray-600 hover:text-gray-800 text-sm flex items-center justify-center gap-2">
                    <i class="fas fa-user-cog"></i>
                    <span class="english-font">Staff Login</span>
                    <span class="chinese-font ml-2">職員登入</span>
                </button>
            </div>
        </div>
    </div>
    
    <!-- 租用者儀表板 | Renter Dashboard -->
    <div id="renterDashboard" class="hidden h-full flex flex-col">
        <!-- 頂部導航欄 | Header -->
        <header class="bg-white shadow-sm sticky top-0 z-40 no-print">
            <div class="max-w-7xl mx-auto px-4 py-4 flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center">
                        <i class="fas fa-door-open text-white"></i>
                    </div>
                    <div class="bilingual-text">
                        <div class="english english-font font-semibold text-gray-800">Room Booking</div>
                        <div class="chinese chinese-font text-sm text-gray-500">歡迎, <span id="renterWelcomeName" class="font-medium"></span></div>
                    </div>
                </div>
                
                <div class="flex items-center gap-2">
                    <button onclick="refreshData()" class="p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition" title="Refresh Data / 刷新數據">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                    <button onclick="logout()" class="px-4 py-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition flex items-center gap-2">
                        <i class="fas fa-sign-out-alt"></i>
                        <span class="english-font">Logout</span>
                        <span class="chinese-font ml-1">登出</span>
                    </button>
                </div>
            </div>
        </header>
        
        <!-- 主要內容區 | Main Content -->
        <main class="flex-1 overflow-auto">
            <div class="max-w-7xl mx-auto px-4 py-6">
                <!-- 頁籤導航 | Tab Navigation -->
                <div class="flex gap-2 mb-6 no-print">
                    <button onclick="showRenterTab('booking')" id="renterTabBooking" class="tab-active px-4 py-2 rounded-lg font-medium transition">
                        <div class="bilingual-text items-center">
                            <div class="english english-font">Book Room</div>
                            <div class="chinese chinese-font text-xs">預約房間</div>
                        </div>
                    </button>
                    <button onclick="showRenterTab('myBookings')" id="renterTabMyBookings" class="tab-inactive px-4 py-2 rounded-lg font-medium transition">
                        <div class="bilingual-text items-center">
                            <div class="english english-font">My Bookings</div>
                            <div class="chinese chinese-font text-xs">我的預約</div>
                        </div>
                    </button>
                    <button onclick="showRenterTab('statistics')" id="renterTabStatistics" class="tab-inactive px-4 py-2 rounded-lg font-medium transition">
                        <div class="bilingual-text items-center">
                            <div class="english english-font">Statistics</div>
                            <div class="chinese chinese-font text-xs">統計</div>
                        </div>
                    </button>
                </div>
                
                <!-- 預約房間區 | Booking Section -->
                <div id="renterBookingSection" class="fade-in">
                    <div class="bg-white rounded-2xl shadow-lg p-6 mb-6">
                        <div class="bilingual-text mb-4">
                            <div class="english english-font text-lg font-semibold text-gray-800 flex items-center">
                                <i class="fas fa-map-marker-alt text-blue-500 mr-2"></i>
                                Select Branch & Date
                            </div>
                            <div class="chinese chinese-font text-gray-600">選擇分店及日期</div>
                        </div>
                        
                        <div class="grid md:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1 bilingual-label">
                                    <span class="english">Branch</span>
                                    <span class="chinese">分店</span>
                                </label>
                                <select id="renterBranchSelect" onchange="loadRoomsForBranch()" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    <option value="">Select Branch / 選擇分店</option>
                                    <option value="jordan">Jordan / 佐敦</option>
                                    <option value="wanchai">Wan Chai / 灣仔</option>
                                    <option value="tsuenwan">Tsuen Wan / 荃灣</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1 bilingual-label">
                                    <span class="english">Date</span>
                                    <span class="chinese">日期</span>
                                </label>
                                <input type="date" id="renterDateSelect" onchange="loadTimeSlots()" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1 bilingual-label">
                                    <span class="english">Room</span>
                                    <span class="chinese">房間</span>
                                </label>
                                <select id="renterRoomSelect" onchange="loadTimeSlots()" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    <option value="">Select Room / 選擇房間</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 房間資訊 | Room Info -->
                    <div id="selectedRoomInfo" class="hidden bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl p-6 mb-6">
                        <div class="flex items-start justify-between">
                            <div>
                                <h3 id="roomInfoName" class="text-xl font-semibold text-gray-800 english-font"></h3>
                                <p id="roomInfoFacilities" class="text-gray-600 mt-1 chinese-font"></p>
                            </div>
                            <div class="text-right">
                                <div class="bilingual-text">
                                    <div class="english english-font text-sm text-gray-500">Price</div>
                                    <div class="chinese chinese-font text-sm text-gray-500">租金</div>
                                </div>
                                <p id="roomInfoPrice" class="text-2xl font-bold text-blue-600"></p>
                                <div class="bilingual-text">
                                    <div class="english english-font text-xs text-gray-400">per hour</div>
                                    <div class="chinese chinese-font text-xs text-gray-400">每小時</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 時間段選擇 | Time Slots -->
                    <div id="timeSlotsContainer" class="hidden bg-white rounded-2xl shadow-lg p-6">
                        <div class="bilingual-text mb-4">
                            <div class="english english-font text-lg font-semibold text-gray-800 flex items-center">
                                <i class="far fa-clock text-blue-500 mr-2"></i>
                                Available Time Slots
                            </div>
                            <div class="chinese chinese-font text-gray-600">可預約時段</div>
                        </div>
                        
                        <div class="bilingual-text mb-4">
                            <div class="english english-font text-sm text-gray-500">Click to select time slots (each slot = 30 mins)</div>
                            <div class="chinese chinese-font text-sm text-gray-500">點擊選擇時段（每格=30分鐘）</div>
                        </div>
                        
                        <div id="timeSlots" class="grid grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-2"></div>
                        
                        <!-- 玩具租用選項 | Toy Rental Option -->
                        <div id="toyRentalOption" class="hidden mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-xl">
                            <label class="flex items-center gap-3 cursor-pointer">
                                <input type="checkbox" id="toyRentalCheckbox" onchange="updateBookingTotal()" class="w-5 h-5 text-yellow-600 rounded focus:ring-yellow-500">
                                <div>
                                    <div class="bilingual-text">
                                        <div class="english english-font text-gray-700 font-medium">Add Toy Rental</div>
                                        <div class="chinese chinese-font text-gray-700 font-medium">租用玩具</div>
                                    </div>
                                    <div class="bilingual-text mt-1">
                                        <div class="english english-font text-sm text-gray-500">Additional <span id="toyPriceDisplay"></span>/hr</div>
                                        <div class="chinese chinese-font text-sm text-gray-500">每小時另加顯示金額</div>
                                    </div>
                                </div>
                            </label>
                        </div>
                        
                        <!-- 預約摘要 | Booking Summary -->
                        <div id="bookingSummary" class="hidden mt-6 p-6 bg-blue-50 rounded-xl border border-blue-200">
                            <div class="flex items-center justify-between mb-6">
                                <div>
                                    <div class="bilingual-text">
                                        <div class="english english-font text-sm text-gray-600">Selected Time</div>
                                        <div class="chinese chinese-font text-sm text-gray-600">已選時段</div>
                                    </div>
                                    <p id="selectedTimeRange" class="font-semibold text-gray-800 text-lg mt-1"></p>
                                </div>
                                <div class="text-right">
                                    <div class="bilingual-text">
                                        <div class="english english-font text-sm text-gray-600">Total</div>
                                        <div class="chinese chinese-font text-sm text-gray-600">總計</div>
                                    </div>
                                    <p id="bookingTotal" class="text-2xl font-bold text-blue-600 mt-1"></p>
                                </div>
                            </div>
                            
                            <button onclick="confirmBooking()" class="w-full bg-gradient-to-r from-blue-500 to-indigo-600 text-white py-3 rounded-xl font-medium hover:from-blue-600 hover:to-indigo-700 transition shadow-md">
                                <span class="english-font">Confirm Booking</span>
                                <span class="chinese-font ml-2">確認預約</span>
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- 我的預約區 | My Bookings Section -->
                <div id="renterMyBookingsSection" class="hidden fade-in">
                    <div class="bg-white rounded-2xl shadow-lg p-6">
                        <div class="bilingual-text mb-4">
                            <div class="english english-font text-lg font-semibold text-gray-800 flex items-center">
                                <i class="far fa-calendar-check text-blue-500 mr-2"></i>
                                My Bookings
                            </div>
                            <div class="chinese chinese-font text-gray-600">我的預約</div>
                        </div>
                        
                        <div id="myBookingsList" class="space-y-4"></div>
                        
                        <div id="noBookingsMessage" class="hidden text-center py-12 text-gray-500">
                            <i class="far fa-calendar-times text-5xl text-gray-300 mb-4"></i>
                            <div class="bilingual-text">
                                <div class="english english-font">No bookings yet</div>
                                <div class="chinese chinese-font mt-1">暫無預約</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 統計區 | Statistics Section -->
                <div id="renterStatisticsSection" class="hidden fade-in">
                    <div class="bg-white rounded-2xl shadow-lg p-6">
                        <div class="flex items-center justify-between mb-6">
                            <div class="bilingual-text">
                                <div class="english english-font text-lg font-semibold text-gray-800 flex items-center">
                                    <i class="fas fa-chart-bar text-blue-500 mr-2"></i>
                                    Monthly Statistics
                                </div>
                                <div class="chinese chinese-font text-gray-600">月度統計</div>
                            </div>
                            
                            <div class="flex items-center gap-2">
                                <select id="statsMonthSelect" onchange="updateRenterStatistics()" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></select>
                                <select id="statsYearSelect" onchange="updateRenterStatistics()" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></select>
                            </div>
                        </div>
                        
                        <!-- 統計卡片 | Stats Cards -->
                        <div class="grid md:grid-cols-3 gap-4 mb-8">
                            <div class="stats-card">
                                <div class="bilingual-text">
                                    <div class="english english-font text-sm text-blue-600 font-medium">Total Bookings</div>
                                    <div class="chinese chinese-font text-sm text-blue-600 font-medium">總預約次數</div>
                                </div>
                                <p id="statsBookingCount" class="text-3xl font-bold text-blue-700 mt-2">0</p>
                            </div>
                            
                            <div class="stats-card" style="background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);">
                                <div class="bilingual-text">
                                    <div class="english english-font text-sm text-green-600 font-medium">Total Hours</div>
                                    <div class="chinese chinese-font text-sm text-green-600 font-medium">總時數</div>
                                </div>
                                <p id="statsTotalHours" class="text-3xl font-bold text-green-700 mt-2">0</p>
                            </div>
                            
                            <div class="stats-card" style="background: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 100%);">
                                <div class="bilingual-text">
                                    <div class="english english-font text-sm text-purple-600 font-medium">Total Amount</div>
                                    <div class="chinese chinese-font text-sm text-purple-600 font-medium">總金額</div>
                                </div>
                                <p id="statsTotalAmount" class="text-3xl font-bold text-purple-700 mt-2">$0</p>
                            </div>
                        </div>
                        
                        <div class="bilingual-text mb-3">
                            <div class="english english-font font-semibold text-gray-800">Booking Details</div>
                            <div class="chinese chinese-font text-gray-600">預約詳情</div>
                        </div>
                        
                        <div id="statsBookingDetails" class="space-y-3"></div>
                        
                        <div id="noStatsMessage" class="hidden text-center py-8 text-gray-500">
                            <i class="far fa-chart-bar text-4xl text-gray-300 mb-4"></i>
                            <div class="bilingual-text">
                                <div class="english english-font">No bookings this month</div>
                                <div class="chinese chinese-font mt-1">本月暫無預約</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <!-- 職員儀表板 | Staff Dashboard -->
    <div id="staffDashboard" class="hidden h-full flex flex-col">
        <!-- 職員頂部導航欄 | Staff Header -->
        <header class="bg-gradient-to-r from-slate-800 to-slate-900 shadow-lg sticky top-0 z-40 no-print">
            <div class="max-w-7xl mx-auto px-4 py-4 flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-white/10 rounded-xl flex items-center justify-center">
                        <i class="fas fa-user-cog text-white"></i>
                    </div>
                    <div class="bilingual-text">
                        <div class="english english-font font-semibold text-white">Staff Portal</div>
                        <div class="chinese chinese-font text-sm text-slate-300">管理後台</div>
                    </div>
                </div>
                
                <div class="flex items-center gap-2">
                    <button onclick="refreshData()" class="p-2 text-slate-300 hover:text-white hover:bg-white/10 rounded-lg transition" title="Refresh Data / 刷新數據">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                    <button onclick="logout()" class="px-4 py-2 text-slate-300 hover:text-white hover:bg-white/10 rounded-lg transition flex items-center gap-2">
                        <i class="fas fa-sign-out-alt"></i>
                        <span class="english-font">Logout</span>
                        <span class="chinese-font ml-1">登出</span>
                    </button>
                </div>
            </div>
        </header>
        
        <!-- 職員主要內容區 | Staff Main Content -->
        <main class="flex-1 overflow-auto">
            <div class="max-w-7xl mx-auto px-4 py-6">
                <!-- 職員頁籤導航 | Staff Tab Navigation -->
                <div class="flex flex-wrap gap-2 mb-6 no-print">
                    <button onclick="showStaffTab('renters')" id="staffTabRenters" class="px-4 py-2 rounded-lg font-medium transition bg-slate-800 text-white">
                        <div class="bilingual-text items-center">
                            <div class="english english-font">Manage Renters</div>
                            <div class="chinese chinese-font text-xs">管理租用者</div>
                        </div>
                    </button>
                    <button onclick="showStaffTab('rooms')" id="staffTabRooms" class="tab-inactive px-4 py-2 rounded-lg font-medium transition">
                        <div class="bilingual-text items-center">
                            <div class="english english-font">Room Settings</div>
                            <div class="chinese chinese-font text-xs">房間設定</div>
                        </div>
                    </button>
                    <button onclick="showStaffTab('allBookings')" id="staffTabAllBookings" class="tab-inactive px-4 py-2 rounded-lg font-medium transition">
                        <div class="bilingual-text items-center">
                            <div class="english english-font">All Bookings</div>
                            <div class="chinese chinese-font text-xs">所有預約</div>
                        </div>
                    </button>
                    <button onclick="showStaffTab('reports')" id="staffTabReports" class="tab-inactive px-4 py-2 rounded-lg font-medium transition">
                        <div class="bilingual-text items-center">
                            <div class="english english-font">Reports</div>
                            <div class="chinese chinese-font text-xs">報表</div>
                        </div>
                    </button>
                </div>
                
                <!-- 管理租用者區 | Manage Renters Section -->
                <div id="staffRentersSection" class="fade-in">
                    <div class="bg-white rounded-2xl shadow-lg p-6 mb-6">
                        <div class="flex items-center justify-between mb-4">
                            <div class="bilingual-text">
                                <div class="english english-font text-lg font-semibold text-gray-800 flex items-center">
                                    <i class="fas fa-users text-slate-700 mr-2"></i>
                                    Renters
                                </div>
                                <div class="chinese chinese-font text-gray-600">租用者</div>
                            </div>
                            
                            <button onclick="showAddRenterModal()" class="px-4 py-2 bg-slate-800 text-white rounded-lg hover:bg-slate-700 transition flex items-center gap-2">
                                <i class="fas fa-user-plus"></i>
                                <span class="english-font">Add Renter</span>
                                <span class="chinese-font ml-1">新增租用者</span>
                            </button>
                        </div>
                        
                        <div id="rentersList" class="space-y-3"></div>
                        
                        <div id="noRentersMessage" class="hidden text-center py-8 text-gray-500">
                            <i class="fas fa-users-slash text-4xl text-gray-300 mb-4"></i>
                            <div class="bilingual-text">
                                <div class="english english-font">No renters registered</div>
                                <div class="chinese chinese-font mt-1">暫無租用者</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 房間設定區 | Room Settings Section -->
                <div id="staffRoomsSection" class="hidden fade-in">
                    <div class="bg-white rounded-2xl shadow-lg p-6">
                        <div class="bilingual-text mb-4">
                            <div class="english english-font text-lg font-semibold text-gray-800 flex items-center">
                                <i class="fas fa-cog text-slate-700 mr-2"></i>
                                Room Price Settings
                            </div>
                            <div class="chinese chinese-font text-gray-600">房間價格設定</div>
                        </div>
                        
                        <div class="bilingual-text mb-6">
                            <div class="english english-font text-sm text-gray-500">Changes will only affect new bookings</div>
                            <div class="chinese chinese-font text-sm text-gray-500">更改只會影響新預約</div>
                        </div>
                        
                        <div class="space-y-8">
                            <!-- 佐敦分店 | Jordan Branch -->
                            <div>
                                <h3 class="font-semibold text-gray-800 mb-3 flex items-center gap-2">
                                    <span class="w-3 h-3 bg-blue-500 rounded-full"></span>
                                    <div class="bilingual-text">
                                        <div class="english english-font">Jordan</div>
                                        <div class="chinese chinese-font text-gray-600">佐敦</div>
                                    </div>
                                </h3>
                                <div id="jordanRooms" class="grid md:grid-cols-2 gap-3"></div>
                            </div>
                            
                            <!-- 灣仔分店 | Wan Chai Branch -->
                            <div>
                                <h3 class="font-semibold text-gray-800 mb-3 flex items-center gap-2">
                                    <span class="w-3 h-3 bg-green-500 rounded-full"></span>
                                    <div class="bilingual-text">
                                        <div class="english english-font">Wan Chai</div>
                                        <div class="chinese chinese-font text-gray-600">灣仔</div>
                                    </div>
                                </h3>
                                <div id="wanchaiRooms" class="grid md:grid-cols-2 gap-3"></div>
                            </div>
                            
                            <!-- 荃灣分店 | Tsuen Wan Branch -->
                            <div>
                                <h3 class="font-semibold text-gray-800 mb-3 flex items-center gap-2">
                                    <span class="w-3 h-3 bg-purple-500 rounded-full"></span>
                                    <div class="bilingual-text">
                                        <div class="english english-font">Tsuen Wan</div>
                                        <div class="chinese chinese-font text-gray-600">荃灣</div>
                                    </div>
                                </h3>
                                <div id="tsuenwanRooms" class="grid md:grid-cols-2 gap-3"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 所有預約區 | All Bookings Section -->
                <div id="staffAllBookingsSection" class="hidden fade-in">
                    <div class="bg-white rounded-2xl shadow-lg p-6">
                        <div class="flex items-center justify-between mb-4">
                            <div class="bilingual-text">
                                <div class="english english-font text-lg font-semibold text-gray-800 flex items-center">
                                    <i class="fas fa-calendar-alt text-slate-700 mr-2"></i>
                                    All Bookings
                                </div>
                                <div class="chinese chinese-font text-gray-600">所有預約</div>
                            </div>
                            
                            <div class="flex items-center gap-2">
                                <select id="staffBookingFilter" onchange="filterStaffBookings()" class="px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    <option value="all">All Renters / 所有租用者</option>
                                </select>
                                
                                <select id="staffBranchFilter" onchange="filterStaffBookings()" class="px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    <option value="all">All Branches / 所有分店</option>
                                    <option value="jordan">Jordan / 佐敦</option>
                                    <option value="wanchai">Wan Chai / 灣仔</option>
                                    <option value="tsuenwan">Tsuen Wan / 荃灣</option>
                                </select>
                            </div>
                        </div>
                        
                        <div id="allBookingsList" class="space-y-3"></div>
                        
                        <div id="noAllBookingsMessage" class="hidden text-center py-8 text-gray-500">
                            <i class="far fa-calendar-times text-4xl text-gray-300 mb-4"></i>
                            <div class="bilingual-text">
                                <div class="english english-font">No bookings found</div>
                                <div class="chinese chinese-font mt-1">找不到預約</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 報表區 | Reports Section -->
                <div id="staffReportsSection" class="hidden fade-in">
                    <!-- 月度報表 | Monthly Report -->
                    <div class="bg-white rounded-2xl shadow-lg p-6 mb-6">
                        <div class="flex items-center justify-between mb-4">
                            <div class="bilingual-text">
                                <div class="english english-font text-lg font-semibold text-gray-800 flex items-center">
                                    <i class="fas fa-chart-pie text-slate-700 mr-2"></i>
                                    Monthly Report
                                </div>
                                <div class="chinese chinese-font text-gray-600">月度報表</div>
                            </div>
                            
                            <div class="flex items-center gap-2">
                                <select id="reportMonthSelect" onchange="generateReport()" class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></select>
                                
                                <select id="reportYearSelect" onchange="generateReport()" class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></select>
                                
                                <button onclick="printReport()" class="px-4 py-2 bg-slate-800 text-white rounded-lg hover:bg-slate-700 transition flex items-center gap-2">
                                    <i class="fas fa-print"></i>
                                    <span class="english-font">Print</span>
                                    <span class="chinese-font ml-1">列印</span>
                                </button>
                            </div>
                        </div>
                        
                        <!-- 列印表頭 | Print Header -->
                        <div class="print-header hidden print-only mb-6">
                            <div class="text-center">
                                <h1 class="text-2xl font-bold text-gray-800 english-font">Monthly Booking Report</h1>
                                <h2 class="text-xl text-gray-600 chinese-font">月度預約報表</h2>
                            </div>
                            <div class="flex justify-between mt-4 text-sm">
                                <div>
                                    <p id="printReportPeriod" class="font-medium"></p>
                                </div>
                                <div>
                                    <p id="printGeneratedDate" class="text-gray-500"></p>
                                </div>
                            </div>
                            <hr class="my-4 border-gray-300">
                        </div>
                        
                        <div id="reportContent">
                            <!-- 統計摘要 | Statistics Summary -->
                            <div class="grid md:grid-cols-4 gap-4 mb-6">
                                <div class="bg-slate-50 rounded-xl p-4 print-border">
                                    <div class="bilingual-text">
                                        <div class="english english-font text-sm text-slate-600">Total Bookings</div>
                                        <div class="chinese chinese-font text-sm text-slate-600">總預約</div>
                                    </div>
                                    <p id="reportTotalBookings" class="text-2xl font-bold text-slate-800 mt-1">0</p>
                                </div>
                                
                                <div class="bg-slate-50 rounded-xl p-4 print-border">
                                    <div class="bilingual-text">
                                        <div class="english english-font text-sm text-slate-600">Total Hours</div>
                                        <div class="chinese chinese-font text-sm text-slate-600">總時數</div>
                                    </div>
                                    <p id="reportTotalHours" class="text-2xl font-bold text-slate-800 mt-1">0</p>
                                </div>
                                
                                <div class="bg-slate-50 rounded-xl p-4 print-border">
                                    <div class="bilingual-text">
                                        <div class="english english-font text-sm text-slate-600">Total Revenue</div>
                                        <div class="chinese chinese-font text-sm text-slate-600">總收入</div>
                                    </div>
                                    <p id="reportTotalRevenue" class="text-2xl font-bold text-slate-800 mt-1">$0</p>
                                </div>
                                
                                <div class="bg-slate-50 rounded-xl p-4 print-border">
                                    <div class="bilingual-text">
                                        <div class="english english-font text-sm text-slate-600">Active Renters</div>
                                        <div class="chinese chinese-font text-sm text-slate-600">活躍租用者</div>
                                    </div>
                                    <p id="reportActiveRenters" class="text-2xl font-bold text-slate-800 mt-1">0</p>
                                </div>
                            </div>
                            
                            <div class="bilingual-text mb-3">
                                <div class="english english-font font-semibold text-gray-800">Breakdown by Renter</div>
                                <div class="chinese chinese-font text-gray-600">按租用者分類</div>
                            </div>
                            
                            <div id="reportByRenter" class="space-y-4"></div>
                            
                            <div id="noReportMessage" class="hidden text-center py-8 text-gray-500">
                                <i class="fas fa-chart-line text-4xl text-gray-300 mb-4"></i>
                                <div class="bilingual-text">
                                    <div class="english english-font">No bookings this month</div>
                                    <div class="chinese chinese-font mt-1">本月暫無預約</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 列印表尾 | Print Footer -->
                        <div class="print-footer hidden print-only mt-8 pt-4 border-t border-gray-300">
                            <div class="flex justify-between text-xs text-gray-500">
                                <div>
                                    <p class="english-font">Generated by Counselling Room Booking System</p>
                                    <p class="chinese-font">心理輔導室預約系統生成</p>
                                </div>
                                <div class="text-right">
                                    <p class="english-font">Page <span class="page-number"></span></p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 生成收據 | Generate Receipt -->
                    <div class="bg-white rounded-2xl shadow-lg p-6">
                        <div class="flex items-center justify-between mb-4">
                            <div class="bilingual-text">
                                <div class="english english-font text-lg font-semibold text-gray-800 flex items-center">
                                    <i class="fas fa-receipt text-slate-700 mr-2"></i>
                                    Generate Receipt
                                </div>
                                <div class="chinese chinese-font text-gray-600">生成收據</div>
                            </div>
                        </div>
                        
                        <div class="flex items-center gap-4 mb-6">
                            <select id="receiptRenterSelect" class="flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                <option value="">Select Renter / 選擇租用者</option>
                            </select>
                            
                            <button onclick="generateReceipt()" class="px-6 py-3 bg-slate-800 text-white rounded-xl hover:bg-slate-700 transition">
                                <span class="english-font">Generate</span>
                                <span class="chinese-font ml-2">生成</span>
                            </button>
                        </div>
                        
                        <div id="receiptPreview" class="hidden receipt-template"></div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <!-- 模態框 | Modals -->
    
    <!-- 新增租用者模態框 | Add Renter Modal -->
    <div id="addRenterModal" class="hidden modal-overlay">
        <div class="modal-content">
            <div class="p-6">
                <div class="bilingual-text mb-4">
                    <div class="english english-font text-xl font-semibold text-gray-800">Add New Renter</div>
                    <div class="chinese chinese-font text-gray-600">新增租用者</div>
                </div>
                
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1 bilingual-label">
                            <span class="english">Name <span class="text-red-500">*</span></span>
                            <span class="chinese">姓名</span>
                        </label>
                        <input type="text" id="newRenterName" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 english-font" placeholder="Enter renter name / 輸入租用者姓名">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1 bilingual-label">
                            <span class="english">Password <span class="text-red-500">*</span></span>
                            <span class="chinese">密碼</span>
                        </label>
                        <input type="text" id="newRenterPassword" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Set password for renter / 為租用者設定密碼">
                        <div class="bilingual-text mt-1">
                            <div class="english english-font text-xs text-gray-500">Password is visible for recovery</div>
                            <div class="chinese chinese-font text-xs text-gray-500">密碼可見以便找回</div>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1 bilingual-label">
                            <span class="english">Email</span>
                            <span class="chinese">電郵</span>
                        </label>
                        <input type="email" id="newRenterEmail" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Enter email address / 輸入電郵地址">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1 bilingual-label">
                            <span class="english">Phone</span>
                            <span class="chinese">電話</span>
                        </label>
                        <input type="tel" id="newRenterPhone" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Enter phone number / 輸入電話號碼">
                    </div>
                </div>
                
                <div id="addRenterError" class="hidden mt-4 text-red-500 text-sm"></div>
                
                <div class="flex gap-3 mt-6">
                    <button onclick="closeAddRenterModal()" class="flex-1 px-4 py-3 border border-gray-300 rounded-xl text-gray-600 hover:bg-gray-50 transition">
                        <div class="bilingual-text items-center">
                            <div class="english english-font">Cancel</div>
                            <div class="chinese chinese-font text-xs">取消</div>
                        </div>
                    </button>
                    <button onclick="addRenter()" id="addRenterBtn" class="flex-1 px-4 py-3 bg-slate-800 text-white rounded-xl hover:bg-slate-700 transition">
                        <div class="bilingual-text items-center">
                            <div class="english english-font">Add</div>
                            <div class="chinese chinese-font text-xs">新增</div>
                        </div>
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 編輯租用者模態框 | Edit Renter Modal -->
    <div id="editRenterModal" class="hidden modal-overlay">
        <div class="modal-content">
            <div class="p-6">
                <div class="bilingual-text mb-4">
                    <div class="english english-font text-xl font-semibold text-gray-800">Edit Renter</div>
                    <div class="chinese chinese-font text-gray-600">編輯租用者</div>
                </div>
                
                <input type="hidden" id="editRenterId">
                
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1 bilingual-label">
                            <span class="english">Name <span class="text-red-500">*</span></span>
                            <span class="chinese">姓名</span>
                        </label>
                        <input type="text" id="editRenterName" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 english-font">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1 bilingual-label">
                            <span class="english">Password <span class="text-red-500">*</span></span>
                            <span class="chinese">密碼</span>
                        </label>
                        <input type="text" id="editRenterPassword" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <div class="bilingual-text mt-1">
                            <div class="english english-font text-xs text-gray-500">Password is visible for recovery</div>
                            <div class="chinese chinese-font text-xs text-gray-500">密碼可見以便找回</div>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1 bilingual-label">
                            <span class="english">Email</span>
                            <span class="chinese">電郵</span>
                        </label>
                        <input type="email" id="editRenterEmail" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1 bilingual-label">
                            <span class="english">Phone</span>
                            <span class="chinese">電話</span>
                        </label>
                        <input type="tel" id="editRenterPhone" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                </div>
                
                <div id="editRenterError" class="hidden mt-4 text-red-500 text-sm"></div>
                
                <div class="flex gap-3 mt-6">
                    <button onclick="closeEditRenterModal()" class="flex-1 px-4 py-3 border border-gray-300 rounded-xl text-gray-600 hover:bg-gray-50 transition">
                        <div class="bilingual-text items-center">
                            <div class="english english-font">Cancel</div>
                            <div class="chinese chinese-font text-xs">取消</div>
                        </div>
                    </button>
                    <button onclick="saveRenterEdit()" id="saveRenterBtn" class="flex-1 px-4 py-3 bg-slate-800 text-white rounded-xl hover:bg-slate-700 transition">
                        <div class="bilingual-text items-center">
                            <div class="english english-font">Save</div>
                            <div class="chinese chinese-font text-xs">儲存</div>
                        </div>
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 職員登入模態框 | Staff Login Modal -->
    <div id="staffLoginModal" class="hidden modal-overlay">
        <div class="modal-content">
            <div class="p-6">
                <div class="bilingual-text mb-4">
                    <div class="english english-font text-xl font-semibold text-gray-800">Staff Login</div>
                    <div class="chinese chinese-font text-gray-600">職員登入</div>
                </div>
                
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1 bilingual-label">
                            <span class="english">Password</span>
                            <span class="chinese">密碼</span>
                        </label>
                        <input type="password" id="staffPassword" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Enter staff password / 輸入職員密碼">
                    </div>
                </div>
                
                <div id="staffLoginError" class="hidden mt-4 text-red-500 text-sm"></div>
                
                <div class="flex gap-3 mt-6">
                    <button onclick="closeStaffLogin()" class="flex-1 px-4 py-3 border border-gray-300 rounded-xl text-gray-600 hover:bg-gray-50 transition">
                        <div class="bilingual-text items-center">
                            <div class="english english-font">Cancel</div>
                            <div class="chinese chinese-font text-xs">取消</div>
                        </div>
                    </button>
                    <button onclick="handleStaffLogin()" class="flex-1 px-4 py-3 bg-slate-800 text-white rounded-xl hover:bg-slate-700 transition">
                        <div class="bilingual-text items-center">
                            <div class="english english-font">Login</div>
                            <div class="chinese chinese-font text-xs">登入</div>
                        </div>
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 取消預約確認模態框 | Cancel Booking Confirmation Modal -->
    <div id="cancelBookingModal" class="hidden modal-overlay">
        <div class="modal-content">
            <div class="p-6 text-center">
                <div class="w-16 h-16 bg-red-100 rounded-full mx-auto mb-4 flex items-center justify-center">
                    <i class="fas fa-exclamation-triangle text-red-500 text-2xl"></i>
                </div>
                
                <div class="bilingual-text mb-2">
                    <div class="english english-font text-xl font-semibold text-gray-800">Cancel Booking?</div>
                    <div class="chinese chinese-font text-gray-600">取消預約？</div>
                </div>
                
                <p id="cancelBookingDetails" class="text-gray-600 mb-6"></p>
                
                <input type="hidden" id="cancelBookingId">
                
                <div class="flex gap-3">
                    <button onclick="closeCancelBookingModal()" class="flex-1 px-4 py-3 border border-gray-300 rounded-xl text-gray-600 hover:bg-gray-50 transition">
                        <div class="bilingual-text items-center">
                            <div class="english english-font">Keep</div>
                            <div class="chinese chinese-font text-xs">保留</div>
                        </div>
                    </button>
                    <button onclick="confirmCancelBooking()" id="confirmCancelBtn" class="flex-1 px-4 py-3 bg-red-500 text-white rounded-xl hover:bg-red-600 transition">
                        <div class="bilingual-text items-center">
                            <div class="english english-font">Cancel Booking</div>
                            <div class="chinese chinese-font text-xs">取消預約</div>
                        </div>
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 通知訊息 | Toast Notification -->
    <div id="toast" class="hidden toast"></div>
    
    <script>
        // ============ GitHub 配置 ============
        let githubConfig = JSON.parse(localStorage.getItem('githubConfig')) || {
            repoOwner: '',
            repoName: 'room-booking-system',
            githubToken: ''
        };
        
        let renters = [];
        let bookings = [];
        let roomPrices = [];
        let currentUser = null;
        let isStaff = false;
        let selectedSlots = [];
        const staffPassword = '123'; // 職員密碼
        
        // 默認房間配置
        const defaultRooms = {
            jordan: [
                { id: 'jordan-c', name: 'Room C / 房間 C', price: 140, facilities: 'Hypnotic Chair / 催眠椅', toyAvailable: false, toyPricePerHour: 0 },
                { id: 'jordan-d', name: 'Room D / 房間 D', price: 190, facilities: 'Group Therapy, Sandplay Therapy / 小組、沙盤遊戲治療', toyAvailable: true, toyPricePerHour: 50 },
                { id: 'jordan-e', name: 'Room E / 房間 E', price: 170, facilities: 'Large Room for Family Therapy / 大房 家庭治療', toyAvailable: false, toyPricePerHour: 0 },
                { id: 'jordan-f', name: 'Room F / 房間 F', price: 150, facilities: 'Floor-to-ceiling Window Counselling Room / 落地窗輔導室', toyAvailable: false, toyPricePerHour: 0 },
                { id: 'jordan-g', name: 'Room G / 房間 G', price: 150, facilities: 'Floor-to-ceiling Window Counselling Room / 落地窗輔導室', toyAvailable: false, toyPricePerHour: 0 }
            ],
            wanchai: [
                { id: 'wanchai-1', name: 'Room 1 / 房間 1', price: 160, facilities: 'Large Window Room, Long Sofa / 窗口大房、長梳化', toyAvailable: false, toyPricePerHour: 0 },
                { id: 'wanchai-2', name: 'Room 2 / 房間 2', price: 140, facilities: 'Comfortable Counselling Room / 舒適輔導室', toyAvailable: false, toyPricePerHour: 0 },
                { id: 'wanchai-3', name: 'Room 3 / 房間 3', price: 140, facilities: 'Comfortable Counselling Room / 舒適輔導室', toyAvailable: false, toyPricePerHour: 0 },
                { id: 'wanchai-4', name: 'Room 4 / 房間 4', price: 180, facilities: 'Group Therapy, Sandplay Therapy / 小組、沙盤遊戲治療', toyAvailable: true, toyPricePerHour: 40 }
            ],
            tsuenwan: [
                { id: 'tsuenwan-5', name: 'Room 5 / 房間 5', price: 130, facilities: 'Counselling Room / 輔導室', toyAvailable: false, toyPricePerHour: 0 },
                { id: 'tsuenwan-6', name: 'Room 6 / 房間 6', price: 140, facilities: 'Counselling Room / 輔導室', toyAvailable: false, toyPricePerHour: 0 },
                { id: 'tsuenwan-7', name: 'Room 7 / 房間 7', price: 140, facilities: 'Counselling Room / 輔導室', toyAvailable: false, toyPricePerHour: 0 },
                { id: 'tsuenwan-8', name: 'Room 8 / 房間 8', price: 160, facilities: 'Large Window Counselling Room / 大窗輔導室', toyAvailable: false, toyPricePerHour: 0 }
            ]
        };
        
        // ============ GitHub API 函數 ============
        
        async function githubRequest(endpoint, method = 'GET', data = null) {
            try {
                const url = `https://api.github.com/repos/${githubConfig.repoOwner}/${githubConfig.repoName}/${endpoint}`;
                
                const headers = {
                    'Accept': 'application/vnd.github.v3+json',
                    'Authorization': `token ${githubConfig.githubToken}`
                };
                
                const options = {
                    method: method,
                    headers: headers
                };
                
                if (data) {
                    options.body = JSON.stringify(data);
                    headers['Content-Type'] = 'application/json';
                }
                
                const response = await fetch(url, options);
                
                if (!response.ok) {
                    throw new Error(`GitHub API Error: ${response.status} ${response.statusText}`);
                }
                
                if (method !== 'DELETE') {
                    return await response.json();
                }
                
                return { success: true };
            } catch (error) {
                console.error('GitHub request error:', error);
                throw error;
            }
        }
        
        // 使用 GitHub Issues 作為數據庫
        async function createIssue(title, body, labels = []) {
            return await githubRequest('issues', 'POST', {
                title: title,
                body: body,
                labels: labels
            });
        }
        
        async function updateIssue(issueNumber, updates) {
            return await githubRequest(`issues/${issueNumber}`, 'PATCH', updates);
        }
        
        async function getIssues() {
            return await githubRequest('issues?state=all&per_page=100');
        }
        
        // 使用 GitHub Gists 作為小型數據庫（替代方案）
        async function createOrUpdateGist(filename, content) {
            // 先檢查是否已存在
            const gists = await githubRequest('gists');
            
            // 查找名為 "booking-data" 的 gist
            const existingGist = gists.find(g => 
                Object.keys(g.files).includes('booking-data.json')
            );
            
            const data = {
                files: {
                    'booking-data.json': {
                        content: JSON.stringify(content, null, 2)
                    }
                },
                description: 'Room Booking System Data',
                public: false
            };
            
            if (existingGist) {
                return await githubRequest(`gists/${existingGist.id}`, 'PATCH', data);
            } else {
                return await githubRequest('gists', 'POST', data);
            }
        }
        
        async function getGistData() {
            try {
                const gists = await githubRequest('gists');
                const bookingGist = gists.find(g => 
                    Object.keys(g.files).includes('booking-data.json')
                );
                
                if (bookingGist) {
                    const response = await fetch(bookingGist.files['booking-data.json'].raw_url);
                    return await response.json();
                }
                return null;
            } catch (error) {
                console.error('Error getting gist data:', error);
                return null;
            }
        }
        
        // ============ 數據操作函數 ============
        
        async function loadAllData() {
            try {
                const data = await getGistData();
                
                if (data) {
                    renters = data.renters || [];
                    bookings = data.bookings || [];
                    roomPrices = data.roomPrices || [];
                } else {
                    // 初始化空數據
                    renters = [];
                    bookings = [];
                    roomPrices = [];
                }
                
                console.log('Data loaded from GitHub:', { 
                    renters: renters.length, 
                    bookings: bookings.length,
                    roomPrices: roomPrices.length 
                });
                
                return true;
            } catch (error) {
                console.error('Error loading data:', error);
                showToast('Error loading data / 載入數據錯誤', 'error');
                return false;
            }
        }
        
        async function saveAllData() {
            try {
                const data = {
                    renters: renters,
                    bookings: bookings,
                    roomPrices: roomPrices,
                    lastUpdated: new Date().toISOString()
                };
                
                await createOrUpdateGist('booking-data.json', data);
                console.log('Data saved to GitHub');
                return true;
            } catch (error) {
                console.error('Error saving data:', error);
                showToast('Error saving data / 儲存數據錯誤', 'error');
                return false;
            }
        }
        
        async function addRenterToGitHub(renterData) {
            const newId = generateId();
            const newRenter = {
                id: newId,
                ...renterData,
                createdAt: new Date().toISOString()
            };
            
            renters.push(newRenter);
            await saveAllData();
            return newId;
        }
        
        async function updateRenterInGitHub(renterId, renterData) {
            const index = renters.findIndex(r => r.id === renterId);
            if (index !== -1) {
                renters[index] = { ...renters[index], ...renterData };
                await saveAllData();
            }
        }
        
        async function deleteRenterFromGitHub(renterId) {
            renters = renters.filter(r => r.id !== renterId);
            bookings = bookings.filter(b => b.renterId !== renterId);
            await saveAllData();
        }
        
        async function addBookingToGitHub(bookingData) {
            const newId = generateId();
            const newBooking = {
                id: newId,
                ...bookingData,
                createdAt: new Date().toISOString()
            };
            
            bookings.push(newBooking);
            await saveAllData();
            return newId;
        }
        
        async function cancelBookingInGitHub(bookingId) {
            const index = bookings.findIndex(b => b.id === bookingId);
            if (index !== -1) {
                bookings[index].status = 'cancelled';
                bookings[index].cancelledAt = new Date().toISOString();
                await saveAllData();
            }
        }
        
        async function updateRoomPriceInGitHub(roomId, priceData) {
            const index = roomPrices.findIndex(p => p.roomId === roomId);
            
            if (index !== -1) {
                roomPrices[index] = { ...roomPrices[index], ...priceData };
            } else {
               
